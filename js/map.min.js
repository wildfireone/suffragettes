var mapBounds=new L.LatLngBounds(new L.LatLng(49.852539,-7.793077),new L.LatLng(60.894042,1.790425)),mapMinZoom=1,mapMaxZoom=17,CartoDB_Positron=L.tileLayer("https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>',subdomains:"abcd",maxZoom:19}),OldMaps=L.tileLayer("http://nls-{s}.tileserver.com/nls/{z}/{x}/{y}.jpg",{minZoom:mapMinZoom,maxZoom:mapMaxZoom,bounds:mapBounds,attribution:'Historical Maps Layer, 1919-1947 from the <a href="http://maps.nls.uk/projects/api/">NLS Maps API</a>',opacity:.85,subdomains:"0123"}),mymap=L.map("mapid",{center:[57.1497,-2.0943],zoom:13,layers:[OldMaps,CartoDB_Positron]}),baseMaps={Historic:OldMaps,Modern:CartoDB_Positron};L.control.layers(baseMaps,null,{collapsed:!1}).addTo(mymap),$('<h6 id="map-title">Map:</h6>').insertBefore("div.leaflet-control-layers-base");var redIcon=new L.Icon({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-red.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]}),blueIcon=new L.Icon({iconUrl:"https://cdn.rawgit.com/pointhi/leaflet-color-markers/master/img/marker-icon-blue.png",shadowUrl:"https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.7/images/marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],shadowSize:[41,41]});$.getJSON("suffra2.json",function(data){var markers=L.markerClusterGroup({spiderfyDistanceMultiplier:2,maxClusterRadius:40});data.forEach(function(location){var m=L.marker([location.lat,location.lng],{icon:blueIcon});m.setBouncingOptions({bounceHeight:20,bounceSpeed:50,exclusive:!0}).on("click",function(){resetAllMarkers(),this.toggleBouncing(),this.isBouncing()?(this.setIcon(redIcon),showSidebar(location)):(resetAllMarkers(),this.setIcon(blueIcon),hideSideBar())}),m.bindPopup("<strong>"+location["pin-title"]+'</strong><span class="d-md-none"><br><a class="js-scroll-trigger" href="#sidebar">More info &rarr;</a></span>'),markers.addLayer(m)}),mymap.addLayer(markers),mymap.fitBounds(markers.getBounds())});var resetAllMarkers=function(){L.Marker._bouncingMarkers.forEach(function(marker){marker._bouncingMotion.isBouncing=!1,marker.setIcon(blueIcon)})};function showSidebar(location){$("#mapid").removeClass("col-md-12"),$("#mapid").addClass("col-md-8"),$("#sidebar").removeClass("col-md-0"),$("#sidebar").addClass("col-md-4"),$("#sidebar").show();var title=location["pin-title"],loc=location.location,desc=location.text,photoSrc=location.photos,photoSrcs=photoSrc.split(" "),photoCaps=location.captions.split("|"),photoString="";for(i=0;i<photoSrcs.length;i++)photoSrc[i]&&(photoString=photoString+"<figure class='figure'><a href='"+photoSrcs[i]+"' data-lightbox='image'"+loc+" data-title='"+loc+(photoCaps[i]?": "+photoCaps[i]:"")+"'><img class='popupimg img-thumbnail figure-img img-fluid rounded' src='"+photoSrcs[i]+"' /></a>"+(photoCaps[i]?"<figcaption class='figure-caption'>Photo: "+photoCaps[i]+"</figcaption>":"")+"</figure>");var content="<div class='pop card'><div class='card-body'><h5 class='card-title'>"+title+"<button type='button' class='close' aria-label='Close sidebar' onclick='hideSideBar()'><span aria-hidden='true'>&times;</span> </button></h5><hr><span class='text-uppercase'><i class='fas fa-map-marker-alt'></i> "+loc+"</span><hr>"+desc+"<hr><p>"+photoString+"</p><span class='d-md-none'><a class='js-scroll-trigger' href='#mapid'>Back to map &uarr;</a></span></div></div>";$("#sidebar").html(content)}function hideSideBar(){$("#sidebar").removeClass("col-md-4"),$("#sidebar").addClass("col-md-0"),$("#mapid").removeClass("col-md-8"),$("#mapid").addClass("col-md-12"),$("#sidebar").hide(),mymap.invalidateSize()}